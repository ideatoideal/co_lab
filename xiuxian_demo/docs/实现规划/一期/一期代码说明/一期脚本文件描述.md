# 战斗系统脚本文件描述

## AIState.cs
- **文件路径**：scripts\battle\AIState.cs
- **功能描述**：定义敌人AI的行为状态枚举
- **主要枚举值**：
  - Attacking: 攻击状态
  - Defending: 防御状态
  - UsingSkill: 使用技能状态
  - Moving: 移动状态
- **使用场景**：EnemyAI.cs中用于控制敌人的行为逻辑切换

## BattleManager.cs
- **文件路径**：scripts\battle\BattleManager.cs
- **功能描述**：战斗系统的核心管理器，负责协调战斗参与者、战斗状态和AI行为
- **主要属性**：
  - _instance: 单例实例
  - _participants: 战斗参与者列表
  - _currentState: 当前战斗状态
  - _battleTimer: 战斗计时器
  - _eventHandlers: 事件处理器字典
  - _enemyAIs: 敌人AI列表
- **主要方法**：
  - Initialize: 初始化战斗管理器，设置参与者和AI
  - StartBattle: 开始战斗
  - EndBattle: 结束战斗
  - Update: 更新战斗状态和参与者
- **设计模式**：单例模式
- **依赖项**：EventBus、BattleParticipant、EnemyAI

## ISkill.cs
- **文件路径**：scripts\battle\ISkill.cs
- **功能描述**：技能系统的接口定义
- **主要属性**：
  - Id: 技能唯一标识
  - Name: 技能名称
  - ManaCost: 魔法消耗
  - Cooldown: 冷却时间
  - CastTime: 施法时间
  - Type: 技能类型
- **主要方法**：
  - Cast: 施放技能
  - CanCast: 检查是否可以施放
  - GetCooldownRemaining: 获取剩余冷却时间
  - UpdateCooldown: 更新冷却时间
- **实现类**：BasicAttack.cs等

## BattleParticipant.cs
- **文件路径**：scripts\battle\BattleParticipant.cs
- **功能描述**：战斗参与者类，存储战斗中角色的基本信息和状态
- **主要属性**：
  - Id: 参与者唯一标识
  - Name: 名称
  - Hp: 当前生命值
  - MaxHp: 最大生命值
  - Mp: 当前魔法值
  - MaxMp: 最大魔法值
  - Attack: 攻击力
  - Defense: 防御力
  - Speed: 速度
  - Position: 位置
  - IsPlayer: 是否为玩家
  - Skills: 技能列表
  - Buffs: 增益效果字典
- **主要方法**：
  - TakeDamage: 受到伤害
  - Heal: 治疗

## EnemyAI.cs
- **文件路径**：scripts\battle\EnemyAI.cs
- **功能描述**：敌人AI实现类，控制敌人的行为和决策
- **主要接口**：IEnemyAI
- **主要属性**：
  - _owner: 所属战斗参与者
  - _currentState: 当前AI状态
  - _decisionTimer: 决策计时器
  - _difficulty: 难度
  - _random: 随机数生成器
- **主要方法**：
  - Update: 更新AI状态和行为
  - MakeDecision: 做出行为决策
- **状态切换**：根据不同状态(Attacking/Defending/UsingSkill/Moving)执行不同行为逻辑

## SkillType.cs
- **文件路径**：scripts\battle\SkillType.cs
- **功能描述**：定义技能类型的枚举
- **主要枚举值**：
  - Attack: 攻击技能
  - Defense: 防御技能
  - Buff: 增益技能
  - Debuff: 减益技能
  - Heal: 治疗技能
- **使用场景**：ISkill接口中用于区分技能类型

# 角色系统脚本文件描述

## CharacterAttributes.cs
- **文件路径**：scripts\characters\CharacterAttributes.cs
- **功能描述**：角色属性系统的核心类，管理所有角色属性
- **主要接口**：IAttributeManager
- **主要属性**：
  - _attributes: 属性缓存字典
  - _attributeDefinitions: 属性定义列表
  - _levelSystem: 等级系统
  - _experienceSystem: 经验系统
- **主要方法**：
  - GetAttribute: 获取属性值
  - GetAttribute(string, AttributeType): 按类型获取属性值
  - CalculateAttributeValue: 计算属性值
- **事件**：
  - OnLevelUp: 升级事件
  - OnAttributeChanged: 属性变更事件
  - OnSystemInitialized: 系统初始化事件

## AttributeDefinition.cs
- **文件路径**：scripts\characters\AttributeDefinition.cs
- **功能描述**：属性定义类，存储属性的基本信息
- **主要字段**：
  - Id: 属性唯一标识
  - Name: 属性名称
  - Type: 属性类型
  - BaseValue: 基础值
  - GrowthRate: 成长率
  - Description: 属性描述
  - IconPath: 图标路径
  - SortOrder: 排序顺序
- **特性**：Serializable

## CharacterLevel.cs
- **文件路径**：scripts\characters\CharacterLevel.cs
- **功能描述**：等级系统的实现类
- **主要接口**：ILevelSystem
- **主要属性**：
  - _currentLevel: 当前等级
  - _currentExperience: 当前经验
  - _experienceToNextLevel: 升级所需经验
  - _attributeGrowthRates: 属性成长率数组
- **主要方法**：
  - GetCurrentLevel: 获取当前等级
  - SetCurrentLevel: 设置当前等级
  - GetCurrentExperience: 获取当前经验
  - UpdateExperienceToNextLevel: 更新升级所需经验
  - UpdateAttributeGrowthRates: 更新属性成长率

## AttributeType.cs
- **文件路径**：scripts\characters\AttributeType.cs
- **功能描述**：定义属性类型的枚举
- **说明**：虽然未直接查看该文件，但从CharacterAttributes.cs的引用可以推断，该枚举定义了角色属性的不同类型，如力量、敏捷、智力等

## ExperienceSystem.cs
- **文件路径**：scripts\characters\ExperienceSystem.cs
- **功能描述**：经验系统的实现类
- **主要接口**：IExperienceSystem
- **说明**：虽然未直接查看该文件，但从CharacterAttributes.cs的引用可以推断，该类负责处理经验获取、升级逻辑等