# 修仙Demo开发方法论

## 1. 概述
本文档定义了修仙Demo项目的开发方法论，综合了模块化开发、测试驱动、增量集成等最佳实践，旨在帮助团队（包括AI协作）更高效地开发高质量、可维护的代码。

## 2. 开发原则
- **用户中心**：所有功能开发以提升用户体验为核心
- **模块化设计**：系统拆分为独立模块，降低耦合度
- **测试驱动**：以测试用例指导开发，确保代码质量
- **持续集成**：频繁集成代码，早期发现问题
- **文档先行**：需求和设计先于代码实现
- **代码规范**：统一编码风格，提升可读性
- **增量开发**：小步快跑，持续交付可用功能

## 3. 开发流程

### 3.1 阶段一：需求与设计
1. **需求分析**：明确功能需求和非功能需求
2. **系统设计**：
   - 模块划分和接口定义
   - 数据结构设计
   - 模块通信规范
3. **文档编写**：
   - 更新《实现规划》文档
   - 编写接口文档
   - 设计测试用例

### 3.2 阶段二：模块开发与测试
1. **测试用例开发**：优先编写单元测试和接口测试
2. **模块代码实现**：
   - 遵循代码规范
   - 实现接口定义
   - 编写必要注释
3. **静态代码分析**：使用分析工具检查代码质量
4. **单元测试**：运行测试用例验证模块功能
5. **代码审查**：团队成员（包括AI）互相审查代码

### 3.3 阶段三：集成与验证
1. **小范围集成**：集成相关模块，测试模块间接口
2. **集成测试**：编写并运行集成测试用例
3. **游戏测试**：启动Godot引擎进行功能验证
4. **问题修复**：根据日志和测试结果修复问题
5. **文档更新**：更新设计文档和API文档

### 3.4 阶段四：发布与迭代
1. **版本发布**：准备测试版本
2. **用户反馈**：收集用户反馈
3. **需求迭代**：基于反馈调整需求和设计
4. **持续改进**：优化代码和流程

## 4. 代码规范
- 遵循项目《代码规范.md》
- C#代码风格统一（命名、缩进、注释等）
- 使用有意义的变量和函数名
- 保持函数简洁，单一职责原则
- 合理添加注释，解释"为什么"而非"是什么"
- 避免冗余代码，提取公共功能

## 5. 测试策略

### 5.1 测试类型
- **单元测试**：验证单个函数或类的功能
- **接口测试**：验证模块间接口的正确性
- **集成测试**：验证多个模块协同工作的正确性
- **功能测试**：验证游戏功能是否符合需求
- **性能测试**：确保游戏运行流畅

### 5.2 测试实践
- 测试用例应覆盖正常流程、边界条件和异常情况
- 测试代码与业务代码分开存放（scripts/tests目录）
- **测试文件命名规范**：测试文件应与被测试文件对应，采用`被测试文件名+Test`的命名格式，如`CharacterAttributes.cs`对应`CharacterAttributesTest.cs`
- **测试目录结构**：测试目录应与业务代码目录结构保持一致，按模块组织测试文件。例如，`scripts/characters/`目录下的代码，其测试文件应放在`scripts/tests/characters/`目录下
- 自动化测试优先，手动测试补充
- 提交代码前必须通过所有测试
- 测试覆盖率目标：核心功能≥80%

## 6. 协作机制

### 6.1 团队协作
- 每日站会：同步进度和问题
- 代码审查：相互学习，提升代码质量
- 文档共享：保持信息透明
- 问题跟踪：使用工具管理bug和任务

### 6.2 与AI协作
- **需求分析**：AI辅助整理和明确需求
- **设计阶段**：AI提供设计建议和备选方案
- **代码实现**：
  - AI生成初始代码
  - 人类审查和优化
  - AI辅助重构和优化
- **测试阶段**：AI辅助编写测试用例
- **文档编写**：AI辅助生成和更新文档

## 7. 质量保证
- **代码质量**：使用静态分析工具（如Roslyn analyzers）
- **构建验证**：提交代码前自动运行测试
- **性能监控**：游戏运行时收集性能数据
- **日志系统**：
  - 分类日志（调试、信息、警告、错误）
  - 包含上下文信息
  - 定期分析日志

## 8. 文档管理
- 所有文档存放在docs目录
- 文档应及时更新，与代码同步
- 使用Markdown格式，确保可读性
- 关键文档包括：
  - 实现规划
  - 模块设计文档
  - 接口文档
  - 代码规范
  - 开发方法论

## 9. 工具链
- **开发环境**：Godot引擎、Visual Studio
- **版本控制**：Git
- **构建工具**：dotnet build
- **测试框架**：NUnit/xUnit
- **静态分析**：Roslyn analyzers
- **文档工具**：Markdown编辑器

## 10. 附则
- 本方法论会根据项目进展和团队反馈持续优化
- 团队成员应共同遵守并提出改进建议
- 新成员加入时需阅读并理解本方法论