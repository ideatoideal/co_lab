# 物品与背包系统设计

## 系统概述
物品与背包系统是修仙世界中管理玩家道具获取、存储、使用的核心机制。本设计将采用**分离式架构**，将常规背包系统与胃部特殊背包系统分开设计，两者通过明确的交互机制协同工作，既保证功能清晰，又满足修仙世界观的特殊设定。

## 设计决策：分离式架构的优势
| 设计方案 | 优势 | 劣势 |
|---------|------|-----|
| 分离式架构 | 1. 功能边界清晰，便于维护和扩展<br>2. 胃部特殊机制（时间流动、消化）独立实现不影响常规背包<br>3. 符合修仙设定中“身体为炉”的概念<br>4. 化形期前后的背包变化过渡自然 | 1. 系统间交互需额外设计<br>2. 初期开发量略大 |
| 合并式架构 | 1. 开发量较小<br>2. 系统间通信简单 | 1. 功能耦合度高，难以扩展<br>2. 胃部特殊机制会复杂化常规背包逻辑<br>3. 化形期前后的设定变化难以平滑过渡 |

## 一、常规背包系统

### 1. 功能定位
管理玩家通过战斗、探索、任务获得的常规道具，提供标准化的物品存储、使用和管理功能。

### 2. 背包容量与界面
- **基础容量**：初始12格，随角色等级提升逐步扩展（每升5级+2格）
- **扩展方式**：通过道具（如“储物袋”）或境界突破（如金丹期开启“须弥芥子”）增加容量
- **界面布局**：网格状布局，支持物品分类查看（全部/消耗品/材料/装备）

### 3. 物品属性
| 属性 | 描述 | 示例 |
|-----|------|-----|
| 类型 | 决定物品的基本行为模式 | 消耗品、材料、装备、法宝碎片 |
| 品质 | 影响物品效果和价值 | 凡品、灵品、宝品、极品、仙品 |
| 效果 | 物品使用或触发后的作用 | 增加灵力、解锁进化分支、提升属性 |
| 堆叠数量 | 单个格子可堆叠的最大数量 | 普通物品99个/格，特殊物品1个/格 |
| 重量 | 影响角色负重和移动速度 | 武器装备通常较重，消耗品较轻 |
| 绑定状态 | 是否可交易或丢弃 | 任务奖励物品通常绑定 |

### 4. 背包操作
| 操作 | 描述 | 限制条件 |
|-----|------|-----|
| 拾取 | 自动或手动拾取场景中的物品 | 背包空间不足时无法拾取 |
| 使用 | 消耗物品并触发其效果 | 部分物品有使用等级或境界限制 |
| 丢弃 | 将物品从背包中移除 | 绑定物品无法丢弃 |
| 合成 | 多个低阶物品合成为高阶物品 | 需要特定配方和合成材料 |
| 整理 | 自动整理背包物品（按类型/品质排序） | 无 |
| 存入/取出 | 与仓库或胃部背包进行物品转移 | 部分特殊物品无法转移 |

## 二、胃部特殊背包系统

### 1. 功能定位
作为修仙者“身体为炉”的具象化系统，模拟食物/物品在体内的消化过程，提供特殊的存储和转化功能。

### 2. 胃部分级机制
| 分级 | 位置 | 消化程度 | 功能 |
|-----|------|---------|-----|
| 一级（口腔） | 入口处 | 未消化 | 临时存储，可随时吐出 |
| 二级（胃部） | 主要消化区 | 正在消化 | 缓慢腐蚀物品耐久，提取基础能量 |
| 三级（肠道） | 吸收区 | 半消化 | 提取物品特殊属性，转化为灵力或血脉精华 |
| 四级（排泄） | 出口处 | 完全消化 | 残余物，即将排出体外 |

### 3. 胃部特性
- **时间流动**：物品会随时间自动从高分级流向低分级（每级停留时间30秒-5分钟，取决于物品类型和角色境界）
- **消化腐蚀**：物品在胃部会持续损失耐久值（耐久为0时完全消化）
- **存储优势**：胃部容量为常规背包的2倍，但只能存储可吞噬/消化的物品（如妖丹、草药、低阶装备）
- **特殊功能**：
  - 部分物品在消化过程中会释放特殊效果（如毒草导致中毒，灵果提升修炼速度）
  - 吞噬特定组合的物品可能触发隐藏效果（如“三株仙草+一枚妖丹”触发“进化觉醒”）

### 4. 境界相关变化
| 境界 | 胃部功能变化 |
|-----|------------|
| 练气期 | 初始开启，容量小，消化慢 |
| 筑基期 | 容量扩大，消化速度提升 |
| 金丹期 | 开启“胃部分级”，可主动控制消化速度 |
| 化形期 | 可选择开启人族形态，使用常规背包为主，胃部转为辅助消化功能 |
| 元婴期 | 胃部与识海连通，可直接提取物品精华 |

## 三、两系统交互机制

### 1. 物品转移
- **从背包到胃部**：玩家可主动将可消化物品从背包放入胃部（需消耗少量灵力）
- **从胃部到背包**：物品在一级（口腔）时可随时吐回背包，二级及以下无法逆向转移
- **自动转移**：消化完成后的有用产物（如精华、碎片）自动转移至背包

### 2. 状态同步
- 背包中物品的使用、丢弃会实时更新数量
- 胃部中物品的消化进度和耐久值变化会实时显示
- 角色负重由背包和胃部共同计算（胃部物品重量为原重量的60%）

### 3. 特殊情况处理
- **饱腹状态**：胃部填满后无法继续放入物品，需等待消化或吐出
- **中毒状态**：消化有毒物品可能导致中毒，需使用解药或等待自然恢复
- **消化异常**：某些特殊物品可能导致消化停滞，需使用特殊道具解决

## 四、未来拓展方向
1. **仓库系统**：添加公共仓库和个人仓库，支持跨角色物品共享
2. **背包皮肤**：推出不同风格的背包界面皮肤，提升视觉体验
3. **物品认主**：高阶装备和法宝可认主，提升属性并绑定
4. **胃部进化**：随着境界提升，胃部可进化出特殊能力（如“火属性胃”加速消化金属物品）
5. **交易系统**：与背包系统联动，支持玩家间物品交易

## 五、与其他系统关联
- **与吞噬系统**：胃部是吞噬行为的直接承接系统，吞噬的物品进入胃部消化
- **与角色属性系统**：背包负重影响角色移动速度和战斗能力
- **与技能系统**：部分技能可影响背包容量或胃部消化速度
- **与进化系统**：进化材料需通过背包和胃部系统获取和处理